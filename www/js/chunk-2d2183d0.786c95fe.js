(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2183d0"],{c9ae:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"dashboard-user-edit-page h-min-screen bg-white p-5 mt-12"},[a("h1",{staticClass:"text-xl font-bold text-gray-700 mb-4"},[e._v(" Add user ")]),a("form",[a("label",{staticClass:"block font-bold letter-spacing-05 mb-1 ml-1 text-gray-600 text-xs uppercase",attrs:{for:"ohrid"}},[e._v("OHR Id")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userOhrid,expression:"userOhrid"}],staticClass:"block appearance-none w-full bg-gray-100 border border-gray-400 hover:border-gray-500 px-4 py-2 rounded leading-tight focus:outline-none",attrs:{id:"ohrid",type:"number",placeholder:"Ex: 30000000",minlength:"7",maxlength:"9",readonly:e.isReadOnly},domProps:{value:e.userOhrid},on:{input:function(t){t.target.composing||(e.userOhrid=t.target.value)}}}),a("label",{staticClass:"block font-bold letter-spacing-05 mt-3 mb-1 ml-1 text-gray-600 text-xs uppercase",attrs:{for:"ohrid"}},[e._v("First Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userFirstName,expression:"userFirstName"}],staticClass:"block appearance-none w-full bg-gray-100 border border-gray-400 hover:border-gray-500 px-4 py-2 rounded leading-tight focus:outline-none",attrs:{id:"ohrid",type:"text",placeholder:"Ex: Rahul",readonly:e.isReadOnly},domProps:{value:e.userFirstName},on:{input:function(t){t.target.composing||(e.userFirstName=t.target.value)}}}),a("label",{staticClass:"block font-bold letter-spacing-05 mt-3 mb-1 ml-1 text-gray-600 text-xs uppercase",attrs:{for:"ohrid"}},[e._v("Last Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userLastName,expression:"userLastName"}],staticClass:"block appearance-none w-full bg-gray-100 border border-gray-400 hover:border-gray-500 px-4 py-2 rounded leading-tight focus:outline-none",attrs:{id:"ohrid",type:"text",placeholder:"Ex: Jain",readonly:e.isReadOnly},domProps:{value:e.userLastName},on:{input:function(t){t.target.composing||(e.userLastName=t.target.value)}}}),a("div",{staticClass:"relative"},[a("label",{staticClass:"block font-bold letter-spacing-05 mt-3 mb-1 ml-1 text-gray-600 text-grey-darkest text-xs uppercase",attrs:{for:"user-role-select"}},[e._v("Admin Role")]),a("div",{staticClass:"relative"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.adminRole,expression:"adminRole"}],ref:"user-role-select",staticClass:"block appearance-none w-full bg-gray-100 border border-gray-400\n          hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight focus:outline-none",attrs:{id:"user-role-select",disabled:e.isAdminReadOnly},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.adminRole=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"1"}},[e._v(" Yes ")]),a("option",{attrs:{value:"0"}},[e._v(" No ")])]),a("div",{staticClass:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600"},[a("svg",{staticClass:"fill-current h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[a("path",{attrs:{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"}})])])])]),a("div",{staticClass:"relative"},[a("label",{staticClass:"block font-bold letter-spacing-05 mt-3 mb-1 ml-1 text-gray-600 text-grey-darkest text-xs uppercase",attrs:{for:"user-role-select"}},[e._v("User role")]),a("div",{staticClass:"relative"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.userRole,expression:"userRole"}],ref:"user-role-select",staticClass:"block appearance-none w-full bg-gray-100 border border-gray-400\n          hover:border-gray-500 px-4 py-2 pr-8 rounded leading-tight focus:outline-none",attrs:{id:"user-role-select",disabled:e.isReadOnly},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.userRole=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v(" --- ")]),a("option",{attrs:{value:"voc"}},[e._v(" VOS ")]),a("option",{attrs:{value:"vod"}},[e._v(" VOD ")])]),a("div",{staticClass:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600"},[a("svg",{staticClass:"fill-current h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[a("path",{attrs:{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"}})])])])]),e.userRole&&("voc"===e.userRole||"vod"===e.userRole)||1==e.adminRole?a("div",{staticClass:"cta-cont text-right mt-8"},[a("button",{staticClass:"border-2 border-gray-300 rounded px-4 py-1 text-gray-700 w-24 mr-3",on:{click:function(t){return t.preventDefault(),e.$router.back()}}},[e._v(" Cancel ")]),e.isReadOnly?e._e():a("button",{staticClass:"border-2 rounded px-4 py-1 w-24",class:e.saveButtonDisable?"border-gray-400 text-gray-500 w-24":"border-green-400 text-green-500",attrs:{disabled:e.saveButtonDisable},on:{click:function(t){return t.preventDefault(),e.saveUser(t)}}},[e._v(" Save ")])]):e._e()])])},n=[],s=(a("99af"),a("4160"),a("a434"),a("b0c0"),a("159b"),a("53ca")),o=(a("96cf"),a("1da1")),i=a("fb66"),c=a.n(i),l=a("e130"),d=a.n(l),u=a("b5ae"),p=a.n(u),m=a("9c7f"),v=a.n(m),h=a("98c2"),g=a.n(h),y=a("e8eb"),b=a.n(y),f=a("762e"),x=a.n(f),w=a("3d37"),C=a.n(w),R={name:"UserEdit",data:function(){return{userId:"",userOhrid:"",userFirstName:"",userLastName:"",userRole:"",adminRole:0,isEditMode:!1,selectedAccount:"",languages:[1],accountData:[],verticalData:[],selectedVertical:"",validationErrors:[],isReadOnly:!1,isAdminReadOnly:!0,editSaveToggle:[],isEditingCompanyVertical:!1,editableCompanyVerticals:[{id:"",companyId:"",verticalId:"",isEditingCompanyVertical:!1,selectedAccount:"",selectedVertical:"",softDeleteRequired:!1}]}},computed:{saveButtonDisable:function(){return 1!==this.adminRole&&""===this.userRole}},watch:{$route:function(e,t){"Dashboard.Admin"===t.name&&"Dashboard.User.Edit"===e.name&&(this.renderReady=!1,this.getUserDetails())}},deactivated:function(){this.userOhrid="",this.userFirstName="",this.userLastName="",this.userRole="",this.adminRole=0,this.selectedAccount="",this.selectedVertical="",this.accountData=[],this.verticalData=[],this.validationErrors=[]},mounted:function(){this.getUserDetails()},methods:{addUser:function(e,t,a,r,n,s,i,l,d){var u=this;return Object(o["a"])(regeneratorRuntime.mark((function o(){var p;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,u.$apollo.mutate({mutation:c.a,variables:{firstName:e,lastName:t,ohrid:a,isVOC:r,isVOD:n,isReviewer:s,isAdmin:i,companyId:l,verticalId:d}});case 3:p=o.sent,console.log("addUser",p),o.next=10;break;case 7:o.prev=7,o.t0=o["catch"](0),console.log(o.t0.message);case 10:case"end":return o.stop()}}),o,null,[[0,7]])})))()},updateUser:function(e,t,a,r){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},addUserToCompanyVertical:function(e,t,a){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.$apollo.mutate({mutation:p.a,variables:{userId:e,companyId:t,verticalId:a}});case 3:s=n.sent,o=s.data,console.log("addUserToCompanyVertical",o),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),console.log(n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},updateCompanyVertical:function(e,t,a,r,n){var s=this;return Object(o["a"])(regeneratorRuntime.mark((function o(){var i,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,s.$apollo.mutate({mutation:v.a,variables:{companyVerticalId:e,companyId:t,verticalId:a,userCompanyId:r,userId:n}});case 3:i=o.sent,c=i.data,console.log("updateCompanyVertical",c),o.next=11;break;case 8:o.prev=8,o.t0=o["catch"](0),console.log(o.t0.message);case 11:case"end":return o.stop()}}),o,null,[[0,8]])})))()},addUserCompany:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.$apollo.mutate({mutation:g.a,variables:{companyVerticalId:e,userId:t}});case 3:n=r.sent,s=n.data,console.log("addUserCompany",s),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),console.log(r.t0.message);case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))()},updateUserCompany:function(e,t,a,r){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,n.$apollo.mutate({mutation:b.a,variables:{userCompanyId:e,companyVerticalId:t,userId:a,isDeleted:r}});case 3:o=s.sent,i=o.data,console.log("updateUserCompany",i),s.next=11;break;case 8:s.prev=8,s.t0=s["catch"](0),console.log(s.t0.message);case 11:case"end":return s.stop()}}),s,null,[[0,8]])})))()},onUserRoleChanged:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("onchange role called !!"),t.next=4,e.$apollo.query({query:d.a});case 4:a=t.sent,r=a.data,e.accountData=r.fetchAllCompanies,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$store.dispatch("addToastNotifications",{text:t.t0.message,timer:4e3,type:"error"});case 12:return t.abrupt("return",e.accountData);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getAllVerticalByCompany:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$apollo.query({query:x.a,variables:{companyId:e}});case 3:r=a.sent,n=r.data,console.log("data is: ".concat(n)),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),t.$store.dispatch("addToastNotifications",{text:a.t0.message,timer:4e3,type:"error"});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},checkUserInput:function(e,t,a){console.log(e,t,a);var r=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/;(a.length<7||a.length>9)&&this.validationErrors.push("OHRID length should be between 7 - 9!"),""===e&&this.validationErrors.push("First Name is Required!"),""===t&&this.validationErrors.push("Last Name is Required!"),r.test(e)&&this.validationErrors.push("Enter valid characters in first name!"),r.test(t)&&this.validationErrors.push("Enter valid characters in last name!")},saveUser:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.userFirstName,r=e.userLastName,n=e.userOhrid,e.checkUserInput(a,r,n),!(e.validationErrors.length>0)){t.next=6;break}return e.validationErrors.forEach((function(t){e.$store.dispatch("addToastNotifications",{text:t,timer:4e3,type:"error"})})),e.validationErrors=[],t.abrupt("return");case 6:return s={firstName:a,lastName:r,ohrid:parseInt(n,10),isVOC:0,isVOD:0,isReviewer:1,isAdmin:0,companyId:0,verticalId:0},"voc"===e.userRole?s.isVOC=1:"vod"===e.userRole?s.isVOD=1:(s.companyId=0,s.verticalId=0),1===e.adminRole&&(s.isAdmin=1),t.prev=9,t.next=12,e.$apollo.mutate({mutation:c.a,variables:s});case 12:if(o=t.sent,i=o.data.addUser.id,o.data.addUser){t.next=16;break}throw new Error("User with OHRID ".concat(n," already exists"));case 16:e.$store.dispatch("addToastNotifications",{text:"User added succesfully!",timer:4e3,type:"success"}),e.$router.push({path:"/dashboard/admin/user/edit/".concat(i,"?isEditMode=true")}),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](9),e.$store.dispatch("addToastNotifications",{text:"".concat(t.t0.message),timer:4e3,type:"error"});case 23:case"end":return t.stop()}}),t,null,[[9,20]])})))()},getUserDetails:function(){var e=this.$route.query,t=e.firstName,a=e.lastName,r=e.ohrid,n=e.isVOC,s=e.isVOD,o=e.isAdmin,i=e.isEditMode,c=e.userId;i?(this.isEditMode=i,t&&(this.userFirstName=t),a&&(this.userLastName=a),r&&(this.userOhrid=r),c&&(this.userId=parseInt(c,10)),1===n&&(console.log("isVOC: ".concat(n)),this.userRole="voc"),1===s&&(console.log("isVOD: ".concat(s)),this.userRole="vod"),o&&(this.adminRole=1),this.isReadOnly=!0):this.isReadOnly=!1,console.log("is read only is: ".concat(this.isReadOnly))},makeCompanyVerticalEditable:function(e){e.isEditingCompanyVertical||(console.log("save details to server: ".concat(e.companyId)),console.log("vertical to server: ".concat(e.verticalId)),e.selectedAccount&&e.selectedAccount.id&&e.selectedAccount.name&&console.log("selectedAccount: ".concat(e.selectedAccount.id,",  name:  ").concat(e.selectedAccount.name)),e.selectedVertical&&e.selectedVertical.id&&e.selectedVertical.name&&console.log("selected vertical: ".concat(e.selectedVertical.id,",   name:  ").concat(e.selectedVertical.name)),e.selectedVertical.id&&e.selectedAccount.id&&(console.log("user is: ".concat(this.userId," type: ").concat(Object(s["a"])(this.userId))),this.addUserToCompanyVertical(this.userId,e.selectedAccount.id,e.selectedVertical.id)))},softDeleteUserCompany:function(e){this.editableCompanyVerticals&&(this.editableCompanyVerticals[e]&&this.editableCompanyVerticals[e].softDeleteRequired&&console.log("id to be deleted from server ".concat(this.editableCompanyVerticals[e].id)),this.editableCompanyVerticals.splice(e,1))},addNewRowForCompanyVertical:function(){var e={id:"",companyId:"",verticalId:"",isEditingCompanyVertical:!1,selectedAccount:"",selectedVertical:"",softDeleteRequired:!1};this.editableCompanyVerticals.push(e)},addNewRowForCompanyVerticalValues:function(e,t,a,r,n){var s={id:e,companyId:t,verticalId:a,isEditingCompanyVertical:!1,selectedAccount:r,selectedVertical:n,softDeleteRequired:!0};this.editableCompanyVerticals.push(s)},getUserCompanyVerticals:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$apollo.query({query:C.a,variables:{id:parseInt(e.userId,10)}});case 3:a=t.sent,r=a.data,console.log("publish Data :".concat(r)),r.publicUserCompanyList&&r.publicUserCompanyList.length>0&&(e.editableCompanyVerticals.splice(0,1),r.publicUserCompanyList.forEach((function(t){var a=t.companyId,r=t.verticalId,n=t.companyVerticalId,s=t.company;console.log("selected Row :".concat(t.company));var o=t.vertical;e.addNewRowForCompanyVerticalValues(n,a,r,s,o)}))),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("getUserCompanyVerticals => error is: ".concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},deleteUserRecord:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("companyvertical id is: ".concat(e," with type ").concat(Object(s["a"])(e)," and ").concat(t," with type ").concat(Object(s["a"])(t))),r.prev=1,r.next=4,a.$apollo.query({query:C.a,variables:{companyVerticalId:parseInt(a.companyVerticalId,10),userId:parseInt(a.userId,10)}});case 4:n=r.sent,o=n.data,o.publicUserCompanyList&&o.publicUserCompanyList.length>0&&(a.editableCompanyVerticals.splice(0,1),o.publicUserCompanyList.forEach((function(e){var t=e.companyId,r=e.verticalId,n=e.companyVerticalId,s=e.company,o=e.vertical;a.addNewRowForCompanyVerticalValues(n,t,r,s,o)}))),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](1),console.log("getUserCompanyVerticals => error is: ".concat(r.t0));case 12:case"end":return r.stop()}}),r,null,[[1,9]])})))()},getAllCompanyVerticals:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("getAllCompanyVerticals:"),t.next=4,e.$apollo.query({query:C.a});case 4:a=t.sent,r=a.data,r.getAllCompanyVerticals&&r.getAllCompanyVerticals.length>0&&console.log("length:  ".concat(r.getAllCompanyVerticals.length)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("getAllCompanyVerticals => error is: ".concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}}},V=R,I=a("2877"),O=Object(I["a"])(V,r,n,!1,null,null,null);t["default"]=O.exports}}]);
//# sourceMappingURL=chunk-2d2183d0.786c95fe.js.map